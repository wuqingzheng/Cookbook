## 2.7 分页处理 - Paging In Process
虚拟内存管理的最后阶段将页面移入物理内存，无论是从后台存储还是从包含页面数据的文件中移出。内存访问错误会启动页面输入过程。当代码尝试访问未映射到物理内存的虚拟地址处的数据时，会发生内存访问故障。有两种故障：

* 当引用地址的页面驻留在物理内存中但当前未映射到此进程的地址空间时，会发生软故障（soft fault）。
* 当被引用地址的页面不在物理内存中但被交换到后备存储（或可从映射文件中获得）时，会发生硬故障。这就是通常所说的页面错误。

当发生任何类型的错误时，内核会为访问区域查找映射条目和 VM对象。内核然后遍历 VM对象的常驻页面列表。如果所需页面位于常驻页面列表中，则内核会生成软错误。如果该页面不在常驻页面列表中，则会生成严重故障。

对于软故障，内核将包含页面的物理内存映射到进程的虚拟地址空间。内核然后将特定页面标记为活动的。如果错误涉及写入操作，则该页面也会被标记为已修改，以便稍后将其释放到后备存储中。

对于硬故障，VM 对象的寻呼机根据寻呼机的类型在后备存储中或从磁盘上的文件中查找页面。在对地图信息进行适当的调整之后，寻呼机将页面移动到物理存储器并将页面置于活动列表中。与软故障一样，如果故障涉及写操作，则页面被标记为已修改。