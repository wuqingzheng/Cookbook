## 2.6 Paging In 处理 - Paging In Process
虚拟内存管理的最后阶段将页面移入物理内存，无论是从后备存储还是从包含页面数据的文件中移入。内存访问错误会启动 **page-in** 过程。当代码尝试访问未映射到物理内存的虚拟地址上的数据时，就会发生内存访问故障。有两种故障：

* 软故障（soft fault）发生在当被引用地址的页面驻留在物理内存中但当前未映射到此进程的地址空间时。
* 硬故障（hard fault）发生在当被引用地址的页面不在物理内存中而是被交换到后备存储（或可从映射文件中获得）时。这就是通常所说的页面错误（page fault）。

当发生任何类型的错误时，内核会为访问区域查找映射条目（map entry）和 VM 对象。内核然后遍历 VM 对象的常驻页面列表。如果所需页面位于常驻页面列表中，则内核会生成软错误。如果该页面不在常驻页面列表中，则会生成硬故障。

对于软故障，内核将包含页面的物理内存映射到进程的虚拟地址空间。内核然后将特定页面标记为活动的。如果故障涉及写入操作，则该页面也会被标记为已修改，以便稍后将其释放到后备存储中。

对于硬故障，VM 对象的 **pager** 根据 **pager** 的类型在后备存储中或从磁盘上的文件中查找页面。在对映射信息进行适当的调整之后，**pager** 将页面移动到物理存储器并将页面置于活动列表中。与软故障一样，如果故障涉及写操作，则页面被标记为已修改。
