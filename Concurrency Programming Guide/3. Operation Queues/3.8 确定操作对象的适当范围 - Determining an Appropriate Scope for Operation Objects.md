## 3.8 确定操作对象的适当范围 - Determining an Appropriate Scope for Operation Objects
尽管可以向操作队列添加任意多的操作，但这样做通常是不切实际的。NSOperation 类的实例和任何对象一样消耗内存，并且实际开销与它们的执行相关联，如果您的每个操作对象只执行少量工作，并且您创建了数以万计的操作对象，那么您可能会发现调度操作比开展实际工作花费更多时间。而如果您的应用程序已经受到内存限制，您可能会发现仅仅在内存中有数以万计的操作对象就可能会进一步降低性能。

有效使用操作的关键是在您需要做的工作量和保持计算机繁忙之间找到适当的平衡点。尽量确保您的操作执行合理的工作量。例如，如果您的应用程序创建 100 个操作对象以在 100 个不同的值上执行相同的任务，请考虑创建 10 个操作对象，以便每个处理 10 个值。

您还应该避免同时向队列中添加大量操作，或者避免不断将操作对象添加到队列中的速度大于它们处理的速度。而不是用操作对象充满队列，而是批量（batches）创建这些对象。当一批完成执行时，使用 completion block 告诉你的应用程序创建一个新的批处理。当你有很多工作要做时，你想让队列充满足够的操作，以便计算机保持忙碌状态，但是你不希望一次创建那么多操作，导致应用程序内存不足。

当然，您创建的操作对象的数量以及您在每个操作中执行的工作量都是可变的，并且完全取决于您的应用程序。您应该始终使用诸如 instruments 之类的工具来帮助您在效率和速度之间找到适当的平衡点。有关 instruments 的概述以及可用于收集代码度量标准的其他性能工具，请参阅 [Performance Overview](https://developer.apple.com/library/content/documentation/Performance/Conceptual/PerformanceOverview/Introduction/Introduction.html#//apple_ref/doc/uid/TP40001410)。